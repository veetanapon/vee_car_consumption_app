<!DOCTYPE html>
<html lang="th">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
    <title>Vehicle Detail</title>
    <link rel="stylesheet" href="css/style.css" />
    <style>
        /* ===== VEHICLE PAGE ONLY ===== */
        body {
            background: var(--bg-app);
        }

        .vh-left select {
            background: var(--bg-soft);
            border: none;
            border-radius: 12px;
            padding: 6px 10px;
            color: var(--text-main);
        }

        .vh-right div {
            background: none;
            border: none;
            font-size: 20px;
            margin-left: 8px;
            color: var(--text-main);
        }

        .back-btn {
            position: sticky;
            top: calc(env(safe-area-inset-top) + 56px);
            /* ‡∏ï‡πà‡∏≥‡∏Å‡∏ß‡πà‡∏≤ header */
            margin-left: 12px;
            margin-top: 8px;
            z-index: 25;

            background: var(--bg-card);
            border-radius: 12px;
            padding: 6px 10px;
            box-shadow: var(--shadow-sm);
            border: none;
            font-size: 18px;
        }

        /* Hero */
        .vehicle-hero {
            margin-top: 8px;
            /* ‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á 110px ‡πÅ‡∏•‡πâ‡∏ß */
            padding: 0 16px;
            text-align: center;
        }

        .vehicle-image-frame {
            width: 100%;
            max-width: 440px;
            height: 220px;
            /* ‡∏Ñ‡∏∏‡∏°‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏π‡∏á */
            margin: 0 auto;
            border-radius: 20px;
            background: var(--bg-soft);
            overflow: hidden;
            /* ‡∏ï‡∏±‡∏î‡∏´‡∏±‡∏ß‚Äì‡∏ó‡πâ‡∏≤‡∏¢ */
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .vehicle-image-frame img {
            width: 100%;
            height: 100%;
            object-fit: contain;
            /* ‡πÑ‡∏°‡πà‡∏ö‡∏µ‡∏ö */
            object-position: center;
            object-fit: cover;
            object-position: center 55%;
        }

        .vehicle-title {
            margin-bottom: 8px;
            font-size: 13px;
            color: var(--text-sub);
        }

        /* Summary Card */
        .summary-card {
            margin: 8px 16px;
            padding: 16px;
            background: var(--bg-card);
            border-radius: 20px;
            box-shadow: var(--shadow-sm);
        }

        .summary-top {
            display: flex;
            justify-content: space-between;
            margin-bottom: 14px;
        }

        .summary-top span {
            font-size: 11px;
            color: var(--text-sub);
        }

        .summary-top strong {
            display: block;
            font-size: 18px;
        }

        .summary-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
        }

        .mini-card {
            padding: 12px;
            border-radius: 14px;
            background: var(--bg-soft);
            font-size: 12px;
        }

        .mini-card strong {
            display: block;
            margin-top: 4px;
            font-size: 14px;
        }

        /* Energy bar */
        .energy-bar {
            display: flex;
            height: 8px;
            border-radius: 999px;
            overflow: hidden;
            margin-top: 12px;
            background: var(--bg-soft);
        }

        .energy-seg {
            height: 100%;
            font-size: 9px;
            line-height: 14px;
            text-align: center;
            color: #fff;
            white-space: nowrap;
        }
        /* History */
        .fuel-history {
            margin: 16px 16px 48px 16px;
            padding: 16px;
            background: var(--bg-card);
            border-radius: 20px;
            box-shadow: var(--shadow-sm);
        }

        .history-header {
            display: flex;
            justify-content: space-between;
            margin-bottom: 12px;
            font-size: 14px;
            font-weight: 600;
        }

        .fuel-item {
            font-size: 13px;
            padding: 8px 0;
            border-bottom: 1px solid var(--border-soft);
        }

        .fuel-item:last-child {
            border-bottom: none;
        }

        .fab {
            position: fixed;
            bottom: 20px;
            right: 20px;
            width: 56px;
            height: 56px;
            border-radius: 50%;
            background: #22c55e;
            color: #fff;
            font-size: 26px;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 6px 16px rgba(0, 0, 0, .3);
            cursor: pointer;
            z-index: 50;
        }

        .bottom-sheet.show {
            transform: translateY(0);
        }

        .bottom-sheet.hidden {
            display: none;
        }

        .sheet-header {
            display: flex;
            justify-content: space-between;
            padding: 12px 16px;
            font-weight: bold;
            border-bottom: 1px solid #eee;
        }

        .sheet-body {
            padding: 16px;
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        /* etype / ftype */
        #e_etype,
        #e_ftype {
            height: 44px;
            font-size: 16px;
            min-width: 90px;
        }

        .sheet-body input,
        .sheet-body select,
        .sheet-body button {
            padding: 10px;
            font-size: 16px;
        }

        /* input height ‡πÉ‡∏´‡πâ‡πÄ‡∏ó‡πà‡∏≤‡∏Å‡∏±‡∏ô‡∏´‡∏°‡∏î */
        .sheet-body input,
        .sheet-body select,
        .sheet-body textarea {
            height: 44px;
        }

        /* textarea ‡∏¢‡∏∑‡∏î‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏û‡∏¥‡∏°‡∏û‡πå‡∏´‡∏•‡∏≤‡∏¢‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î */
        .sheet-body textarea {
            min-height: 44px;
            height: auto;
            resize: vertical;
        }

        /* loading button */
        .sheet-body button:disabled {
            opacity: 0.6;
        }

        .sheet-body .row {
            display: flex;
            gap: 8px;
            align-items: center;
            align-items: stretch;
        }

        .sheet-body .flex {
            flex: 1;
        }

        .sheet-body .small {
            width: 80px;
        }

        .unit-label {
            padding: 8px;
            background: var(--bg-soft);
            border-radius: 8px;
            font-size: 14px;
        }

        /* unit label ‡πÉ‡∏´‡πâ‡πÄ‡∏ó‡πà‡∏≤ input */
        #e_unit_label {
            display: flex;
            align-items: center;
            justify-content: center;
            height: 44px;
            min-width: 90px;
            font-size: 15px;
            font-weight: 500;
        }

        .sheet-body #e_total_price_label {
            width: 90px !important;
            text-align: center;
        }

        /* record container */
        .fuel-row {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 12px;
            margin-bottom: 10px;
            background: var(--bg-soft);
            border-radius: 16px;
        }

        /* icon */
        .fuel-icon {
            box-shadow: inset 0 0 0 1px rgba(255, 255, 255, 0.4);
            width: 44px;
            height: 44px;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
            font-weight: 600;
            flex-shrink: 0;
        }

        /* info */
        .fuel-info {
            flex: 1;
        }

        .fuel-station {
            font-size: 15px;
            font-weight: 700;
        }

        .fuel-meta {
            font-size: 12px;
            color: var(--text-sub);
        }

        /* price */
        .fuel-price {
            text-align: right;
        }

        .fuel-total {
            font-size: 15px;
            font-weight: 700;
        }

        .fuel-unit {
            font-size: 12px;
            color: var(--text-sub);
        }

        .fuel-e85 .fuel-icon,
        .energy-seg.fuel-e85 {
            background: #fee2e2;
            color: #b91c1c;
        }

        .fuel-e20 .fuel-icon,
        .energy-seg.fuel-e20 {
            background: #fdcb8a;
            color: #92400e;
        }

        .fuel-g95 .fuel-icon,
        .energy-seg.fuel-g95 {
            background: #cffafe;
            color: #0e7490;
        }

        .fuel-g91 .fuel-icon,
        .energy-seg.fuel-g91 {
            background: #dcfce7;
            color: #166534;
        }

        .fuel-g97 .fuel-icon,
        .energy-seg.fuel-g97,
        .energy-seg.fuel-gpremium {
            background: #5b21b6;
            color: #fefde9;
        }

        .fuel-dc .fuel-icon,
        .energy-seg.fuel-dc {
            background: #e0f2fe;
            color: #0369a1;
        }

        .fuel-ac .fuel-icon,
        .energy-seg.fuel-ac {
            background: #f1f5f9;
            color: #334155;
        }
    </style>
</head>

<body>
    <!-- Header -->
    <header class="container">
        <!-- <h1>My Cars</h1> -->
        <div class="vh-left">
            <select id="carDropdown"></select>
        </div>
        <div style="display:flex; gap:14px; align-items:center">
            <!-- <div class="theme-toggle" onclick="toggleTheme()">üåì</div> -->
            <div class="noti" onclick="loadNotifications()">
                üîî
                <div id="badge" class="badge" style="display:none">0</div>
            </div>
        </div>
    </header>

    <button class="back-btn" onclick="history.back()">‚Üê</button>
    <!-- Hero -->
    <section class="vehicle-hero">
        <div class="vehicle-image-frame">
            <img id="vehicleImage" />
        </div>
        <div class="vehicle-title" id="vehicleTitle"></div>
    </section>

    <!-- Summary -->
    <section class="summary-card">
        <div class="summary-top">
            <div>
                <span>‡πÑ‡∏°‡∏•‡πå‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô</span>
                <strong id="lastOdo">-</strong>
            </div>
            <div>
                <span>‡∏Ñ‡πà‡∏≤‡πÉ‡∏ä‡πâ‡∏à‡πà‡∏≤‡∏¢‡∏£‡∏ß‡∏°</span>
                <strong id="totalCost" style="text-align: right;">-</strong>
            </div>
        </div>

        <div class="summary-grid">
            <div class="mini-card">
                ‡∏£‡∏∞‡∏¢‡∏∞‡∏ó‡∏≤‡∏á‡∏£‡∏ß‡∏°
                <strong id="totalDistance">-</strong>
            </div>
            <div class="mini-card">
                ‡πÄ‡∏ï‡∏¥‡∏°/‡∏ä‡∏≤‡∏£‡πå‡∏à‡πÑ‡∏õ
                <strong id="energyCount">-</strong>
            </div>
            <div class="mini-card">
                ‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢‡∏ï‡πà‡∏≠‡∏£‡∏∞‡∏¢‡∏∞‡∏ó‡∏≤‡∏á
                <strong id="avgCost">-</strong>
            </div>
            <div class="mini-card">
                ‡∏≠‡∏±‡∏ï‡∏£‡∏≤‡∏™‡∏¥‡πâ‡∏ô‡πÄ‡∏õ‡∏•‡∏∑‡∏≠‡∏á
                <strong id="efficiency">-</strong>
            </div>
        </div>
        <div class="energy-bar" id="energyBar"></div>
    </section>

    <!-- History -->
    <section class="fuel-history">
        <div class="history-header">
            <span>‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡πÄ‡∏ï‡∏¥‡∏°‡∏û‡∏•‡∏±‡∏á‡∏á‡∏≤‡∏ô <span id="logsCount"></span></span>
            <button onclick="openDateFilter()">üìÖ</button>
        </div>
        <div id="fuelList"></div>
    </section>

    <!-- Date Filter Sheet -->
    <div id="dateFilterModal" class="date-filter">
        <div class="filter-box" onclick="event.stopPropagation()">

            <div class="filter-title">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ä‡πà‡∏ß‡∏á‡πÄ‡∏î‡∏∑‡∏≠‡∏ô</div>

            <!-- FROM -->
            <div class="picker-section">
                <div class="picker-label">‡∏à‡∏≤‡∏Å</div>
                <div class="picker">
                    <div class="wheel" id="fromMonth"></div>
                    <div class="wheel" id="fromYear"></div>
                </div>
            </div>

            <!-- TO -->
            <div class="picker-section">
                <div class="picker-label">‡∏ñ‡∏∂‡∏á</div>
                <div class="picker">
                    <div class="wheel" id="toMonth"></div>
                    <div class="wheel" id="toYear"></div>
                </div>
            </div>

            <div class="filter-actions">
                <button class="cancel" onclick="closeDateFilter()">‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å</button>
                <button class="apply" onclick="applyDateFilter()">‡∏ï‡∏Å‡∏•‡∏á</button>
            </div>
        </div>
    </div>
    <!-- FAB -->
    <button class="fab" onclick="openEnergySheet(CURRENT_VEHICLE_TYPE)">+</button>
    <!-- Bottom Sheet -->
    <div id="energySheet" class="sheet hidden">
        <div class="sheet-header">
            <span>‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏≤‡∏£‡πÄ‡∏ï‡∏¥‡∏°‡∏û‡∏•‡∏±‡∏á‡∏á‡∏≤‡∏ô</span>
            <button onclick="closeEnergySheet()">&times;</button>
        </div>

        <div class="sheet-body">
            <!-- ‡πÅ‡∏ñ‡∏ß‡∏ó‡∏µ‡πà 1: ‡∏™‡∏ñ‡∏≤‡∏ô‡∏µ + ‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó -->
            <div class="row">
                <select id="e_station_name" class="flex"></select>
                <input id="e_type" value="fuel" hidden /> <!-- // vehicle type fuel/ev -->
                <select id="e_etype" class="small">
                    <option value="dc">DC</option>
                    <option value="ac">AC</option>
                </select>

                <select id="e_ftype" class="small">
                    <option value="g95">G95</option>
                    <option value="g91">G91</option>
                    <option value="e20">E20</option>
                    <option value="gpremium">G95 Premium/G97</option>
                    <option value="e85">E85</option>
                    <option value="bensine">‡πÄ‡∏ö‡∏ô‡∏ã‡∏¥‡∏ô</option>
                </select>
            </div>

            <!-- ‡πÄ‡∏•‡∏Ç‡πÑ‡∏°‡∏•‡πå -->
            <input id="e_odometer" type="number" placeholder="‡πÄ‡∏•‡∏Ç‡πÑ‡∏°‡∏•‡πå‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô" />

            <!-- ‡πÅ‡∏ñ‡∏ß‡∏ó‡∏µ‡πà 2: ‡∏õ‡∏£‡∏¥‡∏°‡∏≤‡∏ì + ‡∏´‡∏ô‡πà‡∏ß‡∏¢ -->
            <div class="row">
                <input id="e_qty" type="number" placeholder="‡∏õ‡∏£‡∏¥‡∏°‡∏≤‡∏ì" />
                <span id="e_unit_label" class="unit-label">Liter</span>
            </div>

            <!-- ‡πÅ‡∏ñ‡∏ß‡∏ó‡∏µ‡πà 3: ‡∏£‡∏≤‡∏Ñ‡∏≤ -->
            <div class="row">
                <input id="e_price_per_unit" type="number" placeholder="‡∏£‡∏≤‡∏Ñ‡∏≤‡∏ï‡πà‡∏≠‡∏´‡∏ô‡πà‡∏ß‡∏¢" />
                <!-- <span class="unit-label">=</span> -->
                <input id="e_total_price_label" type="number" placeholder="‡πÄ‡∏õ‡πá‡∏ô‡πÄ‡∏á‡∏¥‡∏ô" />
                <!-- <span id="e_total_price_label">0.00 ‡∏ø</span> -->
            </div>

            <!-- ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà -->
            <input id="e_date" type="datetime-local" />

            <!-- ‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏ -->
            <textarea id="e_notes" rows="2" placeholder="‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏ (‡∏Å‡∏î Enter ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Ç‡∏∂‡πâ‡∏ô‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î‡πÉ‡∏´‡∏°‡πà)"></textarea>

            <button onclick="submitEnergy()">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å</button>
        </div>
    </div>

    <script src="js/config.js"></script>
    <script src="js/auth.js"></script> <!-- shared -->
    <script src="js/app.js"></script> <!-- shared -->
    <script src="js/vehicle.js"></script> <!-- vehicle only -->

</body>

</html>